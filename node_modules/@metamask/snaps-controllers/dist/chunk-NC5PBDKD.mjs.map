{"version":3,"sources":["../src/snaps/RequestQueue.ts"],"sourcesContent":["export class RequestQueue {\n  public readonly maxQueueSize: number;\n\n  private readonly queueSizes: Map<string, number>;\n\n  constructor(maxQueueSize: number) {\n    this.maxQueueSize = maxQueueSize;\n    this.queueSizes = new Map<string, number>();\n  }\n\n  /**\n   * Increments the queue count for a particular origin.\n   *\n   * @param origin - A string identifying the origin.\n   */\n  public increment(origin: string) {\n    const currentCount = this.queueSizes.get(origin) ?? 0;\n    if (currentCount >= this.maxQueueSize) {\n      throw new Error('Maximum number of requests reached. Try again later.');\n    }\n    this.queueSizes.set(origin, currentCount + 1);\n  }\n\n  /**\n   * Decrements the queue count for a particular origin.\n   *\n   * @param origin - A string identifying the origin.\n   */\n  public decrement(origin: string) {\n    const currentCount = this.queueSizes.get(origin) ?? 0;\n    if (currentCount === 0) {\n      throw new Error(\n        `Cannot decrement, ${origin} does not have any outstanding requests.`,\n      );\n    }\n    this.queueSizes.set(origin, currentCount - 1);\n  }\n\n  /**\n   * Gets the queue count for a particular origin.\n   *\n   * @param origin - A string identifying the origin.\n   * @returns The queue count for the origin.\n   */\n  public get(origin: string): number {\n    return this.queueSizes.get(origin) ?? 0;\n  }\n}\n"],"mappings":";AAAO,IAAM,eAAN,MAAmB;AAAA,EAKxB,YAAY,cAAsB;AAChC,SAAK,eAAe;AACpB,SAAK,aAAa,oBAAI,IAAoB;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOO,UAAU,QAAgB;AAC/B,UAAM,eAAe,KAAK,WAAW,IAAI,MAAM,KAAK;AACpD,QAAI,gBAAgB,KAAK,cAAc;AACrC,YAAM,IAAI,MAAM,sDAAsD;AAAA,IACxE;AACA,SAAK,WAAW,IAAI,QAAQ,eAAe,CAAC;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOO,UAAU,QAAgB;AAC/B,UAAM,eAAe,KAAK,WAAW,IAAI,MAAM,KAAK;AACpD,QAAI,iBAAiB,GAAG;AACtB,YAAM,IAAI;AAAA,QACR,qBAAqB,MAAM;AAAA,MAC7B;AAAA,IACF;AACA,SAAK,WAAW,IAAI,QAAQ,eAAe,CAAC;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQO,IAAI,QAAwB;AACjC,WAAO,KAAK,WAAW,IAAI,MAAM,KAAK;AAAA,EACxC;AACF;","names":[]}