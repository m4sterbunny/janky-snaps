{"version":3,"sources":["../src/webpack/loaders/function.ts"],"sourcesContent":["import type { LoaderDefinitionFunction } from 'webpack';\n\n/**\n * Options for the function loader.\n */\nexport type FunctionLoaderOptions = {\n  /**\n   * The function to execute. This is bound to the loader context, so it can\n   * access the loader options and other properties.\n   */\n  fn: LoaderDefinitionFunction;\n};\n\n/**\n * A loader that executes a function. See {@link getFunctionLoader} for more\n * information.\n *\n * @param content - The input file contents as a `Uint8Array`.\n * @returns The output of the function.\n */\nconst loader: LoaderDefinitionFunction<FunctionLoaderOptions> = function (\n  content,\n) {\n  const { fn } = this.getOptions();\n  return fn.bind(this)(content);\n};\n\nexport default loader;\n\n/**\n * Get a loader that executes the given function. This is useful for executing\n * loaders without needing to pass a file to Webpack.\n *\n * @param fn - The function to execute.\n * @param options - The options to pass to the loader.\n * @returns The loader definition.\n */\nexport function getFunctionLoader<Options>(\n  fn: LoaderDefinitionFunction<Options>,\n  options: Options,\n) {\n  return {\n    // We use `__filename` as the loader, so Webpack will execute the loader in\n    // this file, with the actual function in the options.\n    loader: __filename,\n    options: {\n      fn,\n      ...options,\n    },\n  };\n}\n\n// When running as CJS, we need to export the loader as a default export, since\n// `tsup` exports it as `loader_default`.\n// istanbul ignore next 3\n// eslint-disable-next-line n/no-process-env\nif (typeof module !== 'undefined' && process?.env?.NODE_ENV !== 'test') {\n  module.exports = loader;\n  module.exports.getFunctionLoader = getFunctionLoader;\n  module.exports.raw = true;\n}\n"],"mappings":";AAoBA,IAAM,SAA0D,SAC9D,SACA;AACA,QAAM,EAAE,GAAG,IAAI,KAAK,WAAW;AAC/B,SAAO,GAAG,KAAK,IAAI,EAAE,OAAO;AAC9B;AAEA,IAAO,mBAAQ;AAUR,SAAS,kBACd,IACA,SACA;AACA,SAAO;AAAA;AAAA;AAAA,IAGL,QAAQ;AAAA,IACR,SAAS;AAAA,MACP;AAAA,MACA,GAAG;AAAA,IACL;AAAA,EACF;AACF;AAMA,IAAI,OAAO,WAAW,eAAe,SAAS,KAAK,aAAa,QAAQ;AACtE,SAAO,UAAU;AACjB,SAAO,QAAQ,oBAAoB;AACnC,SAAO,QAAQ,MAAM;AACvB;","names":[]}